## Управление данными в Ext JS

В Ext JS `Store` представляет собой коллекцию данных, которую можно связывать с компонентами, такими как сетки (`Grid`), формы и другие элементы интерфейса. `Store` служит для загрузки данных, их обработки (фильтрация, сортировка) и управления ими.

### Создание Store

Для создания хранилища данных (Store), используется метод Ext.create. Хранилище обычно содержит модели данных, которые описывают структуру данных.

```javascript
// Создание Store для списка пользователей
Ext.create('Ext.data.Store', {
    storeId: 'userStore', // Уникальный идентификатор хранилища
    model: 'User', // Модель данных (определяет структуру данных)

    proxy: {
        type: 'ajax', // Тип источника данных - AJAX-запрос
        url: '/users', // URL для получения данных с сервера
        reader: {
            type: 'json', // Формат данных - JSON
            rootProperty: 'users' // Корневое свойство для данных
        }
    },
    autoLoad: true, // Автоматическая загрузка данных при создании
});
```

#### Объяснение:
- `storeId`: Уникальный идентификатор для хранилища, который позволяет ссылаться на него в других частях приложения.
- `model`: Определяет модель данных, которая будет использоваться в этом хранилище.
- `proxy`: Указывает, откуда хранилище будет загружать данные. В данном случае это AJAX-запрос к URL `/users`.
- `autoLoad`: При значении `true` данные будут загружены автоматически после создания хранилища.


### Определение модели данных

Прежде чем создать `Store`, нужно определить модель данных, которая описывает структуру объектов, загружаемых в хранилище.

`Ext.data.Model` в Ext JS — это класс, который представляет собой объект данных с определенной структурой. Модели данных используются для описания и работы с данными, которые хранятся и управляются через `Store`. Модели определяют структуру данных, типы полей и методы для работы с данными.

### Основные аспекты Ext.data.Model
1. **Определение модели**
   - Модель определяется с помощью Ext.define, где указывается структура данных (поля) и расширяется базовая модель `Ext.data.Model`.
2. **Поля модели**
    - Поля модели определяют структуру данных. Для каждого поля указывается имя и тип данных.
3. **Методы модели**
    - Модели могут иметь собственные методы для обработки данных или выполнения определенных действий.

```javascript
// Определение модели для пользователей
Ext.define('User', {
    extend: 'Ext.data.Model', // Расширяет базовую модель Ext JS
    fields: [
        { name: 'id', type: 'int' },  // Поле ID (числовое)
        { name: 'name', type: 'string' }, // Поле имени пользователя (строка)
        { name: 'email', type: 'string' } // Поле email пользователя (строка)
    ]
});
```
#### Объяснение:

- `fields`: Массив объектов, где каждый объект описывает поле модели. Включает name (имя поля) и type (тип данных).
- `extend`: `Ext.data.Model`: Указывает, что модель расширяет базовый класс `Ext.data.Model`, что позволяет использовать функциональность модели данных Ext JS.

### Методы модели
Модели также могут включать методы, которые позволяют выполнять действия с данными.

```javascript
// Определение модели с методами
Ext.define('User', {
    extend: 'Ext.data.Model',
    fields: [
        { name: 'id', type: 'int' },
        { name: 'name', type: 'string' },
        { name: 'email', type: 'string' }
    ],

    // Метод для получения полного имени пользователя
    getFullName: function() {
        return this.get('name') + ' (' + this.get('email') + ')';
    }
});
```

### Объяснение:
- `getFullName`: Метод модели, который возвращает строку, объединяющую имя и email пользователя. Использует метод `this.get()` для получения значений полей модели.

### Использование модели с Store
После определения модели, вы можете использовать её в Store для управления данными.

```javascript
// Создание Store с использованием модели
Ext.create('Ext.data.Store', {
    model: 'User', // Указывает модель данных, которую будет использовать Store
    proxy: {
        type: 'ajax',
        url: '/users',
        reader: {
            type: 'json',
            rootProperty: 'users'
        }
    },
    autoLoad: true
});
```

### Объяснение:
- `model`: Связывает хранилище данных (`Store`) с определенной моделью (`User`), что позволяет `Store` управлять данными в соответствии с структурой модели.


### Сортировка и фильтрация данных

Хранилище данных можно сортировать и фильтровать.

#### Пример сортировки:

```javascript
// Сортировка хранилища по полю 'name'
var userStore = Ext.getStore('userStore');
userStore.sort('name', 'ASC'); // Сортировка по возрастанию
```

#### Пример фильтрации:

```javascript
// Фильтрация пользователей по имени
userStore.filter('name', 'John');
```

#### Объяснение:

- `sort`: Метод сортировки данных в хранилище по указанному полю и направлению.
- `filter`: Метод фильтрации данных по указанному полю и значению.

### Связывание Store с компонентами

Хранилище часто связывается с компонентами для отображения данных, например, с таблицей (`Grid`).

```javascript
// Создание компонента Grid с привязанным хранилищем данных
Ext.create('Ext.grid.Panel', {
    title: 'Users List',
    store: Ext.data.StoreManager.lookup('userStore'), // Привязка хранилища данных
    columns: [
        { text: 'ID', dataIndex: 'id' }, // Колонка для отображения ID
        { text: 'Name', dataIndex: 'name' }, // Колонка для отображения имени
        { text: 'Email', dataIndex: 'email' } // Колонка для отображения email
    ],
    height: 300,
    width: 400,
    renderTo: Ext.getBody() // Рендеринг компонента на странице
});
```

#### Объяснение:

- `store`: Привязка хранилища к компоненту `Grid`, что позволяет автоматически загружать и отображать данные.
- `columns`: Описание столбцов таблицы, которые будут отображать данные из полей модели.

### Заключение
- `Ext.data.Model` — это основной строительный блок для работы с данными в Ext JS. Он описывает структуру данных и предоставляет методы для работы с этими данными, что позволяет легко интегрировать модели с хранилищами данных и компонентами интерфейса.
- `Store` — это ключевой инструмент в Ext JS для управления данными в приложениях. Оно помогает загружать, хранить, фильтровать и отображать данные, а также обеспечивает легкую интеграцию с различными компонентами интерфейса, такими как таблицы и списки.

## Ссылки на другие файлы

#### 1. [Работа с моделями данных](./model.md)
#### 2. [Пример использования компонентов](./components.md)
#### 3. [Работа с событиями](./events.md)